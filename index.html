<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tombstone Grand Hotel â€“ Housekeeping System</title>
  <style>
    :root {
      --accent: #005ea0;
      --text: #222;
      --bg: #fff;
      --border: #e5e7eb;
      --running: #22c55e;
      --idle: #9ca3af;
      --arrival: #fff7e6;
      --stayover: #ecfdf5;
      --departure: #fef2f2;
    }
    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      height: 100%;
    }
    header {
      background: var(--accent);
      color: #fff;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
    }
    h1 {
      margin: 0;
      font-size: 1.3rem;
    }
    #clock, #lastUpdated {
      font-weight: 600;
      font-size: 0.9rem;
    }

    /* Login screen */
    #loginScreen {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: linear-gradient(160deg, #f0f4f8, #dbeafe);
    }
    .login-box {
      background: #fff;
      padding: 28px 34px;
      border-radius: 10px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
      width: 320px;
      text-align: center;
    }
    .login-box h2 {
      margin-bottom: 18px;
      color: var(--accent);
      font-size: 1.3rem;
    }
    .login-box input {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    .login-box button {
      width: 100%;
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 10px;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    .login-box button:hover {
      background: #00447d;
    }
    .error {
      color: red;
      font-size: 0.9rem;
      margin-top: 6px;
    }

    /* Dashboard */
    #dashboard {
      display: none;
    }
    main {
      padding: 10px;
    }
    #userRole {
      margin-bottom: 8px;
      font-weight: 600;
      color: #444;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }
    th, td {
      border: 1px solid var(--border);
      padding: 6px;
      text-align: left;
    }
    th {
      background: #f3f4f6;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    tr:nth-child(even) {
      background: #fafafa;
    }
    .status-arrival { background: var(--arrival); }
    .status-stayover { background: var(--stayover); }
    .status-departure { background: var(--departure); }

    .timer.running {
      color: var(--running);
      font-weight: 600;
    }
    .timer.idle {
      color: var(--idle);
    }

    /* Responsive */
    @media(max-width:768px){
      table, thead, tbody, th, td, tr {
        display: block;
      }
      thead {
        display: none;
      }
      tr {
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 6px;
      }
      td {
        border: none;
        display: flex;
        justify-content: space-between;
        padding: 6px 8px;
      }
      td::before {
        content: attr(data-label);
        font-weight: 600;
        color: #555;
      }
    }
  </style>
</head>
<body>
  <!-- Login -->
  <div id="loginScreen">
    <div class="login-box">
      <h2>Tombstone Grand Hotel</h2>
      <input type="text" id="username" placeholder="Username" />
      <input type="password" id="password" placeholder="Password" />
      <button id="loginBtn">Login</button>
      <div class="error" id="loginError"></div>
    </div>
  </div>

  <!-- Dashboard -->
  <div id="dashboard">
    <header>
      <h1>Housekeeping Dashboard</h1>
      <div>
        <div id="clock">--:--:--</div>
        <div id="lastUpdated">Last Updated: --</div>
      </div>
    </header>
    <main>
      <div id="userRole"></div>
      <div id="controls"></div>
      <table id="roomTable">
        <thead>
          <tr>
            <th>Room</th>
            <th>Type</th>
            <th>Occupancy</th>
            <th>Guest Status</th>
            <th>HK Status</th>
            <th>Attendant</th>
            <th>Notes</th>
            <th>Timer</th>
          </tr>
        </thead>
        <tbody id="roomBody"></tbody>
      </table>
      <div id="summary"></div>
    </main>
  </div>
<script>
/* ===== CLOCK ===== */
function updateClock(){
  const now=new Date();
  const h=String(now.getHours()).padStart(2,"0");
  const m=String(now.getMinutes()).padStart(2,"0");
  const s=String(now.getSeconds()).padStart(2,"0");
  document.getElementById("clock").textContent=`${h}:${m}:${s}`;
}
setInterval(updateClock,1000); updateClock();
</script>
  <script>
/* === LOGIN & ROLE ACCESS === */
const credentials = {
  manager: "admin2025",
  frontdesk: "fd2025",
  hilda: "hk101",
  johana: "hk102",
  kennedy: "hk103",
  angie: "hk104",
  mayte: "hk105"
};
let currentUser = null;

document.getElementById("loginBtn").addEventListener("click", () => {
  const u = document.getElementById("username").value.trim().toLowerCase();
  const p = document.getElementById("password").value.trim();
  const err = document.getElementById("loginError");
  if (credentials[u] && credentials[u] === p) {
currentUser = u;

// Redirect based on role
if (u === "manager" || u === "frontdesk") {
window.location.href = "manager.html";
} else {
document.getElementById("loginScreen").style.display = "none";
document.getElementById("dashboard").style.display = "block";
document.getElementById("userRole").innerHTML =
`<h2>Welcome, ${u.charAt(0).toUpperCase() + u.slice(1)}</h2>`;
initDashboard();
}
}

/* === ROOM DATA (60 TOTAL) === */
const rooms = [
  {room:100,type:"RM2"},{room:101,type:"RM3"},{room:102,type:"RM2"},
  {room:103,type:"RM2"},{room:104,type:"RM2"},{room:105,type:"AC3"},
  {room:106,type:"RM2"},{room:107,type:"RM2"},{room:108,type:"RM2"},
  {room:109,type:"RM2"},{room:110,type:"RM2"},{room:111,type:"RM2"},
  {room:116,type:"AC1"},{room:118,type:"RM2"},{room:119,type:"RM2"},
  {room:120,type:"RM2"},{room:121,type:"RM3"},{room:122,type:"RM2"},
  {room:123,type:"RM3"},{room:125,type:"RM3"},{room:127,type:"RM3"},
  {room:129,type:"RM2"},{room:131,type:"RM2"},{room:133,type:"AC2"},
  {room:135,type:"AC2"},{room:137,type:"RM1"},{room:200,type:"RM2"},
  {room:201,type:"RM3"},{room:202,type:"RM2"},{room:203,type:"RM2"},
  {room:204,type:"RM2"},{room:205,type:"RM2"},{room:206,type:"RM2"},
  {room:207,type:"RM2"},{room:208,type:"RM2"},{room:209,type:"RM2"},
  {room:210,type:"RM2"},{room:211,type:"RM2"},{room:212,type:"SU1"},
  {room:214,type:"RM2"},{room:216,type:"RM2"},{room:218,type:"RM2"},
  {room:219,type:"RM2"},{room:221,type:"RM2"},{room:222,type:"RM3"},
  {room:223,type:"RM3"},{room:224,type:"RM2"},{room:225,type:"RM3"},
  {room:226,type:"RM2"},{room:227,type:"RM3"},{room:228,type:"RM2"},
  {room:229,type:"RM3"},{room:230,type:"RM2"},{room:231,type:"RM1"},
  {room:233,type:"RM2"},{room:235,type:"RM2"},{room:237,type:"RM2"},
  {room:239,type:"RM3"}
];

/* === DASHBOARD INIT === */
function initDashboard() {
  const tbody = document.getElementById("roomBody");
  tbody.innerHTML = "";
  rooms.forEach((r, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td data-label="Room">${r.room}</td>
      <td data-label="Type">${r.type}</td>
      <td data-label="Occupancy">
        <select>
          <option>Vacant</option>
          <option>Occupied</option>
        </select>
      </td>
      <td data-label="Guest Status">
        <select>
          <option>Arriving</option>
          <option>Stay Over</option>
          <option>Departed</option>
        </select>
      </td>
      <td data-label="HK Status">
        <select class="hkStatus">
          <option>Dirty</option>
          <option>In Progress</option>
          <option>Clean</option>
          <option>Inspected</option>
        </select>
      </td>
      <td data-label="Attendant">
        ${["manager","frontdesk"].includes(currentUser) ?
        `<select class="attendant">
          <option>Unassigned</option>
          <option>Hilda</option>
          <option>Johana</option>
          <option>Kennedy</option>
          <option>Angie</option>
          <option>Mayte</option>
        </select>` : currentUser.charAt(0).toUpperCase()+currentUser.slice(1)}
      </td>
      <td data-label="Notes" contenteditable="true"></td>
      <td data-label="Timer" class="timer idle">00:00:00</td>
    `;
    tbody.appendChild(tr);
  });
  attachListeners();
  updateSummary();
}

/* === HOUSEKEEPING STATUS CHANGE === */
let timers = {};
function attachListeners() {
  document.querySelectorAll(".hkStatus").forEach((sel, idx) => {
    sel.addEventListener("change", e => {
      const val = e.target.value;
      const tr = e.target.closest("tr");
      const timerEl = tr.querySelector(".timer");
      if (val === "In Progress") startTimer(timerEl, idx);
      if (["Clean","Inspected"].includes(val)) stopTimer(timerEl, idx);
    });
  });
}

/* === TIMER FUNCTIONS === */
function startTimer(el, idx){
  if(timers[idx]) return;
  const start=Date.now();
  el.classList.remove("idle");
  el.classList.add("running");
  timers[idx]=setInterval(()=>{
    const diff=Date.now()-start;
    const h=String(Math.floor(diff/3600000)).padStart(2,"0");
    const m=String(Math.floor((diff%3600000)/60000)).padStart(2,"0");
    const s=String(Math.floor((diff%60000)/1000)).padStart(2,"0");
    el.textContent=`${h}:${m}:${s}`;
  },1000);
}
function stopTimer(el,idx){
  if(!timers[idx])return;
  clearInterval(timers[idx]);
  timers[idx]=null;
  el.classList.remove("running");
  el.classList.add("idle");
}

/* === SUMMARY BAR === */
function updateSummary(){
  const rows=document.querySelectorAll("#roomBody tr");
  document.getElementById("summary").innerText=`Total Rooms: ${rows.length}`;
}

/* === DAILY RESET 6 AM === */
function checkReset(){
  const last=localStorage.getItem("lastReset");
  const now=new Date();
  const today=now.toDateString();
  const hr=now.getHours();
  if(last!==today && hr>=6){
    localStorage.clear();
    localStorage.setItem("lastReset",today);
    location.reload();
  }
}
setInterval(checkReset,60000);
checkReset();
</script>
<script>
/* === CSV EXPORT === */
function exportCSV() {
  const rows = document.querySelectorAll("#roomBody tr");
  let csv = "Room,Type,Occupancy,Guest Status,HK Status,Attendant,Notes\n";
  rows.forEach(r => {
    const cols = r.querySelectorAll("td, select");
    const room   = r.children[0].innerText.trim();
    const type   = r.children[1].innerText.trim();
    const occ    = r.children[2].querySelector("select").value;
    const guest  = r.children[3].querySelector("select").value;
    const hk     = r.children[4].querySelector("select").value;
    const attEl  = r.children[5].querySelector("select");
    const att    = attEl ? attEl.value : r.children[5].innerText.trim();
    const notes  = r.children[6].innerText.replace(/,/g," ");
    csv += `${room},${type},${occ},${guest},${hk},${att},${notes}\n`;
  });
  const blob = new Blob([csv], { type: "text/csv" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "housekeeping_log.csv";
  a.click();
}

/* === UPDATE LAST UPDATED TIME === */
function updateLastUpdated(){
  const now = new Date();
  const stamp = now.toLocaleString();
  document.getElementById("lastUpdated").textContent = "Last Updated: " + stamp;
}
document.addEventListener("change", updateLastUpdated);

/* === EXPORT BUTTON (MANAGER & FRONTDESK ONLY) === */
window.addEventListener("load", ()=>{
  if(["manager","frontdesk"].includes(currentUser)){
    const btn = document.createElement("button");
    btn.textContent = "Export CSV";
    btn.style.margin = "10px 0";
    btn.onclick = exportCSV;
    document.getElementById("controls").appendChild(btn);
  }
});

/* === MOBILE IMPROVEMENT === */
window.addEventListener("resize", ()=>{
  const width = window.innerWidth;
  document.body.style.fontSize = width < 480 ? "0.9rem" : "1rem";
});
</script>


