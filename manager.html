<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Tombstone Grand Hotel â€“ Manager Dashboard</title>
<style>
:root{
--accent:#005ea0;--text:#222;--bg:#fff;--border:#e5e7eb;
--running:#22c55e;--idle:#9ca3af;--arrival:#fff7e6;
--stay:#ecfdf5;--depart:#fef2f2;
}
html,body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,sans-serif;background:var(--bg);color:var(--text);}
header{background:var(--accent);color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;}
h1{margin:0;font-size:1.3rem;}
#clock{font-weight:600;}
main{padding:10px;}
button{border:none;border-radius:6px;padding:6px 12px;background:var(--accent);color:#fff;cursor:pointer;}
button:hover{background:#00447d;}
table{width:100%;border-collapse:collapse;font-size:0.9rem;}
th,td{border:1px solid var(--border);padding:6px;text-align:left;}
th{background:#f3f4f6;}
.status-arrival{background:var(--arrival);}
.status-stay{background:var(--stay);}
.status-depart{background:var(--depart);}
.timer.running{color:var(--running);font-weight:600;}
.timer.idle{color:var(--idle);}
@media(max-width:768px){
table{font-size:0.8rem;}
th,td{padding:4px;}
h1{font-size:1.1rem;}
}
</style>
</head>
<body>

<header>
<h1>Manager Dashboard</h1>
<div id="clock">--:--:--</div>
</header>

<main>
<div id="controls" style="margin-bottom:8px;">
<button onclick="exportCSV()">Export CSV</button>
<span id="lastUpdated" style="margin-left:12px;font-weight:600;"></span>
</div>

<table id="roomTable">
<thead>
<tr>
<th>Room</th><th>Type</th><th>Occupancy</th><th>Guest Status</th>
<th>HK Status</th><th>Attendant</th><th>Notes</th><th>Timer</th>
</tr>
</thead>
<tbody id="roomBody"></tbody>
</table>
</main>

<script>
/* ===== CLOCK ===== */
function updateClock(){
const n=new Date();
document.getElementById("clock").textContent=
`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}:${n.getSeconds().toString().padStart(2,"0")}`;
}
setInterval(updateClock,1000);updateClock();

/* ===== ROOMS DATA ===== */
const rooms=[
{room:100,type:"RM2"},{room:101,type:"RM3"},{room:102,type:"RM2"},{room:103,type:"RM2"},
{room:104,type:"RM2"},{room:105,type:"AC3"},{room:106,type:"RM2"},{room:107,type:"RM2"},
{room:108,type:"RM2"},{room:109,type:"RM2"},{room:110,type:"RM2"},{room:111,type:"RM2"},
{room:116,type:"AC1"},{room:118,type:"RM2"},{room:119,type:"RM2"},{room:120,type:"RM2"},
{room:121,type:"RM3"},{room:122,type:"RM2"},{room:123,type:"RM3"},{room:125,type:"RM3"},
{room:127,type:"RM3"},{room:129,type:"RM2"},{room:131,type:"RM2"},{room:133,type:"AC2"},
{room:135,type:"AC2"},{room:137,type:"RM1"},{room:200,type:"RM2"},{room:201,type:"RM3"},
{room:202,type:"RM2"},{room:203,type:"RM2"},{room:204,type:"RM2"},{room:205,type:"RM2"},
{room:206,type:"RM2"},{room:207,type:"RM2"},{room:208,type:"RM2"},{room:209,type:"RM2"},
{room:210,type:"RM2"},{room:211,type:"RM2"},{room:212,type:"SU1"},{room:214,type:"RM2"},
{room:216,type:"RM2"},{room:218,type:"RM2"},{room:219,type:"RM2"},{room:221,type:"RM2"},
{room:222,type:"RM3"},{room:223,type:"RM3"},{room:224,type:"RM2"},{room:225,type:"RM3"},
{room:226,type:"RM2"},{room:227,type:"RM3"},{room:228,type:"RM2"},{room:229,type:"RM3"},
{room:230,type:"RM2"},{room:231,type:"RM1"},{room:233,type:"RM2"},{room:235,type:"RM2"},
{room:237,type:"RM2"},{room:239,type:"RM3"}
];

/* ===== BUILD TABLE ===== */
const attendants=["Unassigned","Hilda","Johana","Kennedy","Angie","Mayte"];
const guestOpts=["Vacant","Occupied"];
const statusOpts=["Arriving","Stay Over","Departure"];
const hkOpts=["Dirty","In Progress","Clean","Inspected"];
let timers={};

function initTable(){
const tb=document.getElementById("roomBody");tb.innerHTML="";
rooms.forEach((r,i)=>{
const tr=document.createElement("tr");
tr.innerHTML=`
<td>${r.room}</td>
<td>${r.type}</td>
<td><select>${guestOpts.map(o=>`<option>${o}</option>`).join("")}</select></td>
<td><select>${statusOpts.map(o=>`<option>${o}</option>`).join("")}</select></td>
<td><select class="hkStatus">${hkOpts.map(o=>`<option>${o}</option>`).join("")}</select></td>
<td><select>${attendants.map(a=>`<option>${a}</option>`).join("")}</select></td>
<td contenteditable="true"></td>
<td class="timer idle">00:00:00</td>`;
tb.appendChild(tr);
});
attachListeners();
}
initTable();

/* ===== HK STATUS TIMER ===== */
function attachListeners(){
document.querySelectorAll(".hkStatus").forEach((sel,idx)=>{
sel.addEventListener("change",e=>{
const tr=e.target.closest("tr");
const tm=tr.querySelector(".timer");
const val=e.target.value;
if(val==="In Progress") startTimer(tm,idx);
else if(["Clean","Inspected"].includes(val)) stopTimer(tm,idx);
});
});
}
function startTimer(el,idx){
if(timers[idx])return;
const start=Date.now();
el.classList.add("running");el.classList.remove("idle");
timers[idx]=setInterval(()=>{
const d=Date.now()-start;
const h=String(Math.floor(d/3600000)).padStart(2,"0");
const m=String(Math.floor((d%3600000)/60000)).padStart(2,"0");
const s=String(Math.floor((d%60000)/1000)).padStart(2,"0");
el.textContent=`${h}:${m}:${s}`;
},1000);
}
function stopTimer(el,idx){
if(!timers[idx])return;
clearInterval(timers[idx]);timers[idx]=null;
el.classList.remove("running");el.classList.add("idle");
}

/* ===== EXPORT CSV ===== */
function exportCSV(){
const rows=document.querySelectorAll("#roomBody tr");
let csv="Room,Type,Occupancy,Guest Status,HK Status,Attendant,Notes\n";
rows.forEach(r=>{
const vals=[...r.children].map(td=>td.innerText.replace(/,/g," "));
csv+=vals.join(",")+"\n";
});
const blob=new Blob([csv],{type:"text/csv"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);a.download="housekeeping_log.csv";a.click();
}

/* ===== UPDATE STAMP ===== */
function updateStamp(){
const stamp=new Date().toLocaleString();
document.getElementById("lastUpdated").textContent="Last Updated: "+stamp;
}
document.addEventListener("change",updateStamp);
</script>
</body>
</html>
